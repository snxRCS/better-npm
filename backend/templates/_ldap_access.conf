{% if access_list_id > 0 and access_list.meta.ldap_auth_enabled %}
    # LDAP Authorization via auth_request
    auth_request /ldap-auth;
    auth_request_set $auth_status $upstream_status;

    {% if access_list.pass_auth == 0 or access_list.pass_auth == false %}
    proxy_set_header Authorization "";
    {% endif %}

    # Access Rules: {{ access_list.clients | size }} total
    {% for client in access_list.clients %}
    {{client | nginxAccessRule}}
    {% endfor %}
    {% if access_list.clients.length > 0 %}
    deny all;
    {% endif %}

    # Access checks must...
    {% if access_list.satisfy_any == 1 or access_list.satisfy_any == true %}
    satisfy any;
    {% else %}
    satisfy all;
    {% endif %}
{% endif %}
